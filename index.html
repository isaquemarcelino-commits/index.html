import pygame
import sys
import math

pygame.init()

# Configurações
WIDTH, HEIGHT = 1000, 600
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Mini Futebol")

clock = pygame.time.Clock()

# Cores
GREEN = (34, 139, 34)
WHITE = (255, 255, 255)
RED = (200, 0, 0)
BLUE = (0, 0, 200)
BLACK = (0, 0, 0)

# Jogador
player = pygame.Rect(200, 300, 40, 40)
player_speed = 5

# Bola
ball_pos = [300, 300]
ball_vel = [0, 0]
ball_radius = 15
ball_friction = 0.98

# Goleiro IA
goalkeeper = pygame.Rect(900, 250, 30, 100)
goalkeeper_speed = 4

# Gol
goal = pygame.Rect(950, 200, 20, 200)

score = 0
font = pygame.font.SysFont(None, 48)

def draw_field():
    screen.fill(GREEN)
    pygame.draw.rect(screen, WHITE, (0, 0, WIDTH, HEIGHT), 5)
    pygame.draw.line(screen, WHITE, (WIDTH//2, 0), (WIDTH//2, HEIGHT), 5)
    pygame.draw.rect(screen, WHITE, goal)

def move_goalkeeper():
    if goalkeeper.centery < ball_pos[1]:
        goalkeeper.y += goalkeeper_speed
    elif goalkeeper.centery > ball_pos[1]:
        goalkeeper.y -= goalkeeper_speed

def move_ball():
    ball_pos[0] += ball_vel[0]
    ball_pos[1] += ball_vel[1]
    ball_vel[0] *= ball_friction
    ball_vel[1] *= ball_friction

while True:
    clock.tick(60)

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

        # Chute
        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_SPACE:
                dx = ball_pos[0] - player.centerx
                dy = ball_pos[1] - player.centery
                dist = math.hypot(dx, dy)
                if dist < 60:
                    ball_vel[0] = dx * 0.2
                    ball_vel[1] = dy * 0.2

    keys = pygame.key.get_pressed()

    # Movimento jogador
    if keys[pygame.K_w]:
        player.y -= player_speed
    if keys[pygame.K_s]:
        player.y += player_speed
    if keys[pygame.K_a]:
        player.x -= player_speed
    if keys[pygame.K_d]:
        player.x += player_speed

    move_ball()
    move_goalkeeper()

    # Colisão bola com goleiro
    if goalkeeper.collidepoint(ball_pos[0], ball_pos[1]):
        ball_vel[0] *= -1

    # Gol
    if goal.collidepoint(ball_pos[0], ball_pos[1]):
        score += 1
        ball_pos = [300, 300]
        ball_vel = [0, 0]

    draw_field()

    pygame.draw.rect(screen, RED, player)
    pygame.draw.rect(screen, BLUE, goalkeeper)
    pygame.draw.circle(screen, WHITE, (int(ball_pos[0]), int(ball_pos[1])), ball_radius)

    score_text = font.render(f"Gols: {score}", True, BLACK)
    screen.blit(score_text, (20, 20))

    pygame.display.flip()
